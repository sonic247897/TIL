# 자식 프로세스 생성 과정

1. 프로세스가 `fork()` 시스템 콜을 하게 되면 CPU의 제어권이 **커널**로 넘어가게 되고, 커널은 `fork()`를 호출한 프로세스를 복제해 자식 프로세스를 생성하게 된다.

   실제로 `fork()`를 통해 생성된 프로세스는 부모 프로세스와 **모든 문맥**을 동일하게 가지고 있다.

   - 즉 부모 프로세스의 주소 공간, 프로그램 카운터 등 레지스터 상태, PCB 및 커널스택 등을 그대로 복제하므로
   - 자식 프로세스는 부모 프로세스의 처음부터 수행을 시작하는 것이 아니라 부모 프로세스가 현재 수행한 시점(프로그램 카운터 지점)부터 수행하게 된다.

   > 부모 프로세스가 메인함수의 첫 번째 줄부터 한 줄씩 코드를 수행하다가 `fork()`라는 라인에 이르면 자신과 똑같은 프로세스를 하나 생성하게 되는데, 현재 그 라인까지 수행했다는 기억조차도 똑같은 자식 프로세스가 생성되는 것이다.
   >
   > - 인간으로 말하자면 기억까지 동일한 복제인간을 만드는 것과 같다.
   >
   > 또, 부모와 마찬가지로 방금 전에 자기 자신을 '복제했다'는 기억을 가지게 된다. 그래서 복제된 프로세스는 자기가 복제본이 아니라 원본이며, 자기를 복제해서 복제본이 생성되었다는 기억을 갖게 되는 것이다.

   다만 유일하게 **프로세스 식별자**는 부모 프로세스와 다르다.